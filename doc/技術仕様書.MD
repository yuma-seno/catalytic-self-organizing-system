# 技術仕様書 v2.0: 触媒的自己組織化システム (CSOS)
**Project Name:** Catalytic Self-Organizing System (CSOS)
**Subtitle:** A Bio-Inspired Hierarchical Dynamics Model for Sparse & Autonomous Intelligence
**Date:** 2025-12-25
**Version:** 2.0 (Stable / Verified)

---

## 1. 序論 (Introduction)
従来のディープラーニングモデル（Transformer等）は、静的な幾何学的写像に依存しており、文脈保持のために全履歴の再入力が必要であるなど、計算資源と電力効率の観点で課題を抱えている。
本プロジェクトでは、**人工化学（Artificial Chemistry）**のアプローチを用い、意味を「記号」ではなく「濃度」として扱い、動的な相互作用から知能を創発させる新たなアーキテクチャ **CSOS** を提案する。
本モデルは、**「階層型基底（Hierarchical Basis）」**と**「非線形反応ダイナミクス」**を組み合わせることで、極めて軽量なパラメータ数で、論理演算・パターン認識・自律制御を実現した。

---

## 2. 数理モデル (Mathematical Formulation)

### 2.1. 状態空間の定義
システムの状態は、 $N$ 種類の「意味の原子（Basis Molecule）」の濃度ベクトル $\mathbf{x}^{(t)} \in \mathbb{R}_{\ge 0}^N$ によって表現される。
物理的な座標を持たず、全結合的な反応場（Reaction Field）における相互作用のみで計算が進行する。

### 2.2. ダイナミクス方程式 (Core Dynamics)
時刻 $t$ から $t+1$ への遷移は、以下のプロセスに従う。

1.  **混合と注入 (Mixing & Injection):**
    現在の状態（記憶）と外部入力 $\mathbf{u}^{(t)}$ を混合する。
    $$\tilde{\mathbf{x}} = (1 - \lambda)\mathbf{x}^{(t)} + \mathbf{u}^{(t)} + \mathbf{m}$$
    ここで $\lambda$ は自然減衰率（Decay Rate）、$\mathbf{m}$ は自律的な代謝（Metabolism）を表す。

2.  **化学反応 (Chemical Reaction):**
    触媒テンソル $\mathcal{W}$ を用いて、分子間の相互作用を計算する。
    $$\mathbf{r} = \mathcal{R}(\tilde{\mathbf{x}}, \mathcal{W})$$
    ※ $\mathcal{R}$ の具体的な構造は後述の階層型アーキテクチャによる。

3.  **状態更新 (Update):**
    反応生成物を加算し、活性化関数（ReLU）により非負制約を課す。
    $$\mathbf{x}' = \text{ReLU}(\tilde{\mathbf{x}} + \alpha \cdot \mathbf{r})$$

4.  **正規化 (Normalization):**
    反応場の総量を一定に保つ（ホメオスタシス）。
    $$\mathbf{x}^{(t+1)} = \frac{\mathbf{x}'}{\sum \mathbf{x}' + \epsilon}$$

---

## 3. ネットワークアーキテクチャ (Network Architecture)

計算量の爆発（$O(N^3)$）を防ぎ、かつ鋭い論理的推論能力を維持するため、**階層型反応場 (Hierarchical Reaction Field)** を採用する。

### 3.1. グループ化と階層構造
全 $N$ 個の分子を $G$ 個のグループ（部分空間）に分割する。反応 $\mathcal{R}$ は以下の2つの項の和で近似される。

1.  **局所反応 (Local Reaction):**
    各グループ内での密な相互作用。専門的な論理処理を担当。
    $$\mathbf{r}_{\text{local}} = \bigoplus_{g=1}^{G} \left( \mathcal{W}_{\text{local}}^{(g)} \times_1 \mathbf{x}_g \times_2 \mathbf{x}_g \right)$$
    * 計算量: $O(N^3 / G^2)$

2.  **大域反応 (Global Reaction):**
    グループ間を跨ぐ情報の伝播。線形結合または低ランク近似で実装。
    $$\mathbf{r}_{\text{global}} = \mathbf{W}_{\text{global}} \cdot \tilde{\mathbf{x}}$$

3.  **統合:**
    $$\mathcal{R}(\tilde{\mathbf{x}}) = \mathbf{r}_{\text{local}} + \beta \cdot \mathbf{r}_{\text{global}}$$

この構造により、従来の密結合モデルと比較して **90%以上のパラメータ削減** を実現しつつ、推論精度を維持することに成功した。

---

## 4. 学習手法 (Learning Algorithms)

タスクの性質に応じて、以下の2つの手法が適用可能である。

1.  **BPTT (Backpropagation Through Time):**
    * 用途: 論理回路、言語モデル、パターン認識
    * 特徴: PyTorch等の自動微分を用い、時間方向に展開した計算グラフを通じて $\mathcal{W}$ を最適化する。
2.  **進化戦略 (Evolution Strategy):**
    * 用途: ロボット制御、自律エージェント
    * 特徴: 勾配計算を行わず、パラメータにノイズを加えた個体群を生成・選抜する。モデルが軽量であるため、数世代で収束が可能。

---

## 5. 実験結果 (Experimental Results)

### 5.1. 論理と記憶 (Logic & Memory)
* **タスク:** 時系列順序識別（Sequence Recognition）。`A`→`B` と `B`→`A` の区別。
* **結果:** 学習により、濃度残響（Memory Trace）を利用した時系列XORゲートの構築に成功。Accuracy 100% を達成。

### 5.2. パターン認識 (Pattern Recognition)
* **タスク:** MNIST手書き数字分類。
* **結果:** 画像を64種の分子濃度に変換し、反応させることで **91.09%** の正答率を達成。非線形な特徴抽出能力が証明された。

### 5.3. 言語モデリング (Language Modeling)
* **タスク:** 人工言語コーパスによる単語予測。
* **比較:**
    * Dense Model ($N=64$): 精度高、計算コスト大。
    * Factorized Model (CP分解): 精度低、計算コスト小。論理の「ボケ」が発生。
    * **Hierarchical Model (提案法):** 精度高、計算コスト小。パラメータ数をDense比で **約92%削減** しつつ、同等のLoss収束を確認。

### 5.4. 自律制御 (Autonomous Control)
* **タスク:** 倒立振子 (CartPole-v1)。
* **結果:** 進化戦略により、わずか **7世代** で制御則を獲得（Score 500.0）。反射的な運動制御の実装に成功。

---

## 6. 結論と展望 (Conclusion)
CSOSは、従来の「幾何学的AI」とは異なる「力学的AI」として、以下の特性を持つことが実証された。

1.  **省パラメータ・高効率:** 階層構造により、極めて少ないリソースで動作可能。
2.  **リアルタイム性:** 内部状態を常時保持するため、再計算なしに即座に応答可能。
3.  **自律性:** 生物的な恒常性（Homeostasis）や衝動の実装が容易。

本技術は、エッジデバイスでの常時監視、ロボティクスにおける反射制御、および自律型NPC（Non-Player Character）への応用に適している。